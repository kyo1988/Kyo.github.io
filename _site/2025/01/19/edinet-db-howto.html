<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width initial-scale=1">
<meta property="og:title" content="EDINET XBRLで作る投資家級データベース">

<title>EDINET XBRLで作る投資家級データベース</title>
<meta property="og:description" content="
  TL;DR
  投資家が使える粒度にするための設計と運用の実際。EDINET XBRLから投資家級データベースを構築する完全ガイド。


スキーマ設計

1. 基本テーブル構造
-- 企業マスタ
CREATE TABLE companies (
    company_id VARCHAR(20) PRIM...">
<meta property="og:url" content="https://kyo1988.github.io/2025/01/19/edinet-db-howto.html">
<meta property="og:site_name" content="Kyo Harada — Visage AI / Data Scientist">
<meta property="og:locale" content="ja_JP">

<meta property="article:author" content="https://www.linkedin.com/in/KyoHarada" />

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@kyoHarada">
<meta name="twitter:creator" content="@kyoHarada">
<meta name="twitter:title" content="EDINET XBRLで作る投資家級データベース">
<meta name="twitter:description" content="
  TL;DR
  投資家が使える粒度にするための設計と運用の実際。EDINET XBRLから投資家級データベースを構築する完全ガイド。


スキーマ設計

1. 基本テーブル構造
-- 企業マスタ
CREATE TABLE companies (
    company_id VARCHAR(20) PRIM...">
<meta name="twitter:url" content="https://kyo1988.github.io/2025/01/19/edinet-db-howto.html">

<meta name="keywords" content="Data Scientist, AI, CoreML, Finance, EDINET, RAG, LLM, Consulting">

<meta name="google-site-verification" content="kZFzSU3m_vE_Y0Ja60lWjUOKkeGpV7Ch3CvfLeP8Di4" />

<link rel="icon" href="/Kyo.github.io/images/IMG_0168.ico">
<link rel="stylesheet" href="/Kyo.github.io/css/main.css">
<link rel="canonical" href="https://kyo1988.github.io/2025/01/19/edinet-db-howto.html">
<link rel="alternate" type="application/atom+xml" title="Kyo Harada — Visage AI / Data Scientist" href="https://kyo1988.github.io/feed.xml" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script async defer src="//assets.pinterest.com/js/pinit.js"></script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T222J2Q');</script>
<!-- End Google Tag Manager -->

</head>
<!-- <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-196500796-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-196500796-1');
</script> -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
    CommonHTML: { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em",
    TeX: {
      equationNumbers: { autoNumber: "AMS" },
    }
  });
</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS_CHTML"></script>
<!-- <link type="application/atom+xml" rel="alternate" href="https://kyo1988.github.io/Kyo.github.io/atom.xml" title="Kyo Harada — Visage AI / Data Scientist" /> -->
<!-- <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>EDINET XBRLで作る投資家級データベース | Kyo Harada — Visage AI / Data Scientist</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="EDINET XBRLで作る投資家級データベース" />
<meta name="author" content="Kyo Harada" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="スキーマ設計、ETL、欠損対処、ダッシュボード例。投資家が使える粒度にするための設計と運用の実際。" />
<meta property="og:description" content="スキーマ設計、ETL、欠損対処、ダッシュボード例。投資家が使える粒度にするための設計と運用の実際。" />
<link rel="canonical" href="https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html" />
<meta property="og:url" content="https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html" />
<meta property="og:site_name" content="Kyo Harada — Visage AI / Data Scientist" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-19T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="EDINET XBRLで作る投資家級データベース" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kyo Harada"},"dateModified":"2025-01-19T00:00:00+09:00","datePublished":"2025-01-19T00:00:00+09:00","description":"スキーマ設計、ETL、欠損対処、ダッシュボード例。投資家が使える粒度にするための設計と運用の実際。","headline":"EDINET XBRLで作る投資家級データベース","mainEntityOfPage":{"@type":"WebPage","@id":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html"},"url":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html"}</script>
<!-- End Jekyll SEO tag -->
 -->

<body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T222J2Q"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="container">

  <header class="site-header">

  <div class="wrapper">

    <h1 class="site-title"><a href="/Kyo.github.io">Kyo Harada — Visage AI / Data Scientist</a></h1>
    <h3 class="site-meta">Founder & Data Scientist building on-device AI for skin analytics and finance-grade data products.</h3>

    <nav class="site-nav">
<!--       <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a> -->
      <div class="trigger">
        
        
        <a class="page-link" href="/Kyo.github.io/">Home</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/about/">About</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/about/">About</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/archives/">Archives</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/case-studies/">Case Studies</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/categories/">Categories</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/tags/">Tags</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/guestbook/">Guestbook</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/xml/feed.xml">Subscribe</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/DataScience/">DataScience</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/visualization/">Visualization</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/marketing/">Marketing</a>
        
        
        
        
        
        <a class="page-link" href="/Kyo.github.io/Investment/">Investment</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/Travel/">Travel</a>
        
        
        
        
        
        <a class="page-link" href="/Kyo.github.io/newsletter/">Newsletter</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/press-kit/">Press Kit</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/xml/sitemap.xml">Sitemap</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/work-with-me/">Work with me</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </div>
    </nav>

  </div>

</header>


  

  <div class="page-content">
    <div class="wrapper">
      <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>EDINET XBRLで作る投資家級データベース | Kyo Harada — Visage AI / Data Scientist</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="EDINET XBRLで作る投資家級データベース" />
<meta name="author" content="Kyo Harada" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="スキーマ設計、ETL、欠損対処、ダッシュボード例。投資家が使える粒度にするための設計と運用の実際。" />
<meta property="og:description" content="スキーマ設計、ETL、欠損対処、ダッシュボード例。投資家が使える粒度にするための設計と運用の実際。" />
<link rel="canonical" href="https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html" />
<meta property="og:url" content="https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html" />
<meta property="og:site_name" content="Kyo Harada — Visage AI / Data Scientist" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-19T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="EDINET XBRLで作る投資家級データベース" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kyo Harada"},"dateModified":"2025-01-19T00:00:00+09:00","datePublished":"2025-01-19T00:00:00+09:00","description":"スキーマ設計、ETL、欠損対処、ダッシュボード例。投資家が使える粒度にするための設計と運用の実際。","headline":"EDINET XBRLで作る投資家級データベース","mainEntityOfPage":{"@type":"WebPage","@id":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html"},"url":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html"}</script>
<!-- End Jekyll SEO tag -->



<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "EDINET XBRLで作る投資家級データベース",
  "description": "スキーマ設計、ETL、欠損対処、ダッシュボード例。投資家が使える粒度にするための設計と運用の実際。",
  "datePublished": "2025-01-19T00:00:00+0900",
  "dateModified": "2025-01-19T00:00:00+0000",
  "author": {
    "@type": "Person",
    "name": "Kyo Harada",
    "sameAs": [
      "https://github.com/kyo1988",
      "https://www.visageaiconsulting.com/",
      "https://www.linkedin.com/in/KyoHarada"
    ]
  },
  "publisher": {
    "@type": "Organization",
    "name": "Visage AI Consulting"
  },
  "mainEntityOfPage": {"@type":"WebPage","@id":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/edinet-db-howto.html"}
}
</script>

<div class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 itemprop="name" class="post-title">EDINET XBRLで作る投資家級データベース</h1>
    <meta itemprop="keywords" content="EDINET,Finance,ETL,Case-Study,XBRL,Database" />
    <p class="post-meta">
    Posted in
    
    
    and tagged
    
    <a href="/Kyo.github.io/tags/#EDINET" title="EDINET">EDINET</a>, 
    
    <a href="/Kyo.github.io/tags/#Finance" title="Finance">Finance</a>, 
    
    <a href="/Kyo.github.io/tags/#ETL" title="ETL">ETL</a>, 
    
    <a href="/Kyo.github.io/tags/#Case-Study" title="Case-Study">Case-Study</a>, 
    
    <a href="/Kyo.github.io/tags/#XBRL" title="XBRL">XBRL</a>, 
    
    <a href="/Kyo.github.io/tags/#Database" title="Database">Database</a>
    
    
    <time itemprop="datePublished" datetime="2025-01-19">
    on Jan 19, 2025
    </time>
    </p>
  </header>

  <article class="post-content" itemprop="articleBody">
    <div class="tldr">
  <strong>TL;DR</strong>
  <p>投資家が使える粒度にするための設計と運用の実際。EDINET XBRLから投資家級データベースを構築する完全ガイド。</p>
</div>

<h2 id="スキーマ設計">スキーマ設計</h2>

<h3 id="1-基本テーブル構造">1. 基本テーブル構造</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- 企業マスタ</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">companies</span> <span class="p">(</span>
    <span class="n">company_id</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">company_name</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">industry_code</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">listing_date</span> <span class="nb">DATE</span><span class="p">,</span>
    <span class="n">created_at</span> <span class="nb">TIMESTAMP</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span>
<span class="p">);</span>

<span class="c1">-- 財務データ</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">financial_data</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">BIGINT</span> <span class="n">AUTO_INCREMENT</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">company_id</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
    <span class="n">fiscal_year</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">fiscal_period</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">account_code</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
    <span class="n">account_name</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span>
    <span class="n">amount</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">unit</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">created_at</span> <span class="nb">TIMESTAMP</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
    <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">company_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">companies</span><span class="p">(</span><span class="n">company_id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h3 id="2-インデックス設計">2. インデックス設計</h3>
<ul>
  <li><strong>複合インデックス</strong>: (company_id, fiscal_year, account_code)</li>
  <li><strong>パーティション</strong>: fiscal_yearでパーティション分割</li>
  <li><strong>圧縮</strong>: InnoDB圧縮でストレージ効率化</li>
</ul>

<h2 id="etlパイプライン">ETLパイプライン</h2>

<h3 id="1-データ取得">1. データ取得</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="n">ET</span>

<span class="k">class</span> <span class="nc">EDINETDownloader</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">api_key</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="s">"https://disclosure.edinet-fsa.go.jp/api/v1"</span>
    
    <span class="k">def</span> <span class="nf">download_xbrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc_id</span><span class="p">):</span>
        <span class="s">"""XBRLファイルをダウンロード"""</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">base_url</span><span class="si">}</span><span class="s">/documents/</span><span class="si">{</span><span class="n">doc_id</span><span class="si">}</span><span class="s">"</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">"type"</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>  <span class="c1"># XBRL形式
</span>        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"X-API-KEY"</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">api_key</span><span class="p">}</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">content</span>
        <span class="k">return</span> <span class="bp">None</span>
</code></pre></div></div>

<h3 id="2-データ変換">2. データ変換</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">XBRLParser</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">parse_financial_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xbrl_content</span><span class="p">):</span>
        <span class="s">"""XBRLから財務データを抽出"""</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="p">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xbrl_content</span><span class="p">)</span>
        <span class="n">financial_data</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># 勘定科目の抽出
</span>        <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="n">root</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">".//{http://www.xbrl.org/2003/instance}context"</span><span class="p">):</span>
            <span class="n">context_id</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span>
            <span class="n">period</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">extract_period</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">root</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">".//{http://www.xbrl.org/2003/instance}item"</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"contextRef"</span><span class="p">)</span> <span class="o">==</span> <span class="n">context_id</span><span class="p">:</span>
                    <span class="n">account_code</span> <span class="o">=</span> <span class="n">item</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"name"</span><span class="p">)</span>
                    <span class="n">amount</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span><span class="p">.</span><span class="n">text</span> <span class="k">else</span> <span class="mi">0</span>
                    
                    <span class="n">financial_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s">"context_id"</span><span class="p">:</span> <span class="n">context_id</span><span class="p">,</span>
                        <span class="s">"period"</span><span class="p">:</span> <span class="n">period</span><span class="p">,</span>
                        <span class="s">"account_code"</span><span class="p">:</span> <span class="n">account_code</span><span class="p">,</span>
                        <span class="s">"amount"</span><span class="p">:</span> <span class="n">amount</span>
                    <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">financial_data</span>
</code></pre></div></div>

<h2 id="欠損対処">欠損対処</h2>

<h3 id="1-データクリーニング">1. データクリーニング</h3>
<div class="key-takeaways">
  <strong>Key Takeaways</strong>
  <ul>
    
    
      <li>欠損値の特定: 勘定科目の存在確認</li>
    
      <li>補完方法: 前年同期値または業界平均値</li>
    
      <li>異常値検出: 統計的異常値の特定と除外</li>
    
      <li>データ整合性: 貸借対照表のバランス確認</li>
    
  </ul>
</div>

<h3 id="2-品質管理">2. 品質管理</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DataQualityChecker</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">check_balance_sheet_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="s">"""貸借対照表のバランス確認"""</span>
        <span class="n">assets</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">'account_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Assets'</span><span class="p">][</span><span class="s">'amount'</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
        <span class="n">liabilities</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">'account_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Liabilities'</span><span class="p">][</span><span class="s">'amount'</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
        <span class="n">equity</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">'account_type'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Equity'</span><span class="p">][</span><span class="s">'amount'</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
        
        <span class="n">balance</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">assets</span> <span class="o">-</span> <span class="p">(</span><span class="n">liabilities</span> <span class="o">+</span> <span class="n">equity</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">balance</span> <span class="o">&lt;</span> <span class="mf">0.01</span>  <span class="c1"># 1円未満の差は許容
</span>    
    <span class="k">def</span> <span class="nf">detect_outliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s">'amount'</span><span class="p">):</span>
        <span class="s">"""異常値の検出"""</span>
        <span class="n">Q1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="n">Q3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
        
        <span class="k">return</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">)]</span>
</code></pre></div></div>

<h2 id="ダッシュボード例">ダッシュボード例</h2>

<h3 id="1-財務指標ダッシュボード">1. 財務指標ダッシュボード</h3>
<ul>
  <li><strong>収益性</strong>: ROE, ROA, 営業利益率</li>
  <li><strong>安全性</strong>: 自己資本比率, 流動比率</li>
  <li><strong>効率性</strong>: 総資産回転率, 売上高成長率</li>
  <li><strong>市場評価</strong>: PER, PBR, EV/EBITDA</li>
</ul>

<h3 id="2-業界比較分析">2. 業界比較分析</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_industry_comparison</span><span class="p">(</span><span class="n">company_id</span><span class="p">,</span> <span class="n">industry_code</span><span class="p">):</span>
    <span class="s">"""業界比較分析"""</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s">"""
    SELECT 
        company_id,
        AVG(ROE) as avg_roe,
        AVG(ROA) as avg_roa,
        AVG(営業利益率) as avg_operating_margin
    FROM financial_metrics 
    WHERE industry_code = %s
    GROUP BY company_id
    ORDER BY avg_roe DESC
    """</span>
    <span class="k">return</span> <span class="n">execute_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="n">industry_code</span><span class="p">,))</span>
</code></pre></div></div>

<h2 id="運用監視">運用監視</h2>

<section class="qa">
  <h2>Q&amp;A</h2>
  
  <dl>
  
    
    
    
    
      <dt>データ更新頻度は？</dt>
      <dd>四半期ごと（3月・6月・9月・12月）の決算発表後</dd>
    
  
    
    
    
    
      <dt>監視すべき指標は？</dt>
      <dd>データ取得成功率・処理時間・データ品質スコア</dd>
    
  
    
    
    
    
      <dt>障害時の対応は？</dt>
      <dd>アラート通知・自動再試行・手動復旧手順</dd>
    
  
  </dl>
</section>

<h2 id="成果物">成果物</h2>

<ul>
  <li><strong>データベース</strong>: MySQL/PostgreSQLで構築</li>
  <li><strong>ETLパイプライン</strong>: Python + Airflowで自動化</li>
  <li><strong>ダッシュボード</strong>: Grafana + InfluxDBで可視化</li>
  <li><strong>API</strong>: RESTful APIでデータ提供</li>
</ul>

<h2 id="参考資料">参考資料</h2>

<ul>
  <li><a href="https://disclosure.edinet-fsa.go.jp/api/v1/">EDINET API Documentation</a></li>
  <li><a href="https://www.xbrl.org/">XBRL Specification</a></li>
  <li><a href="https://pandas.pydata.org/">Financial Data Analysis</a></li>
</ul>

<div class="cta">
  <h3>相談・見積りのご依頼</h3>
  <p>小さく速く、成果物ベースでご一緒します。</p>
  <p>
    <a class="btn" href="/work-with-me/">Work with me</a>
    <a class="btn ghost" href="/newsletter/">無料ニュースレター</a>
  </p>
</div>

<div class="related">
  <h3>次に読む</h3>
  <ul>
  
    
      
      
      
        <li><a href="/Kyo.github.io/2025/01/19/rag-audit-checklist.html">RAGミニ監査チェックリスト（無料DL）</a></li>
        
      
    
  
    
      
      
      
    
  
    
      
      
      
    
  
    
  
    
      
      
      
        <li><a href="/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html">CoreML最適化プレイブック（受託）</a></li>
        
      
    
  
    
      
      
      
        <li><a href="/Kyo.github.io/2025/01/19/coreml-optimization-playbook-en.html">CoreML Optimization Playbook (Consulting)</a></li>
        
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
  </ul>
</div>


  </article>
  <hr />
</div>


<div>
  <h1>Related Posts</h1>
  <ul>
  
    <li><a href="/2025/01/19/rag-audit-checklist.html">RAGミニ監査チェックリスト（無料DL）</a></li>
  
    <li><a href="/2025/01/19/founders-log-01.html">Founder's Log #01 — 週報</a></li>
  
    <li><a href="/2025/01/19/founders-log-01-en.html">Founder's Log #01 — Weekly Update</a></li>
  
    <li><a href="/2025/01/19/coreml-optimization-playbook.html">CoreML最適化プレイブック（受託）</a></li>
  
    <li><a href="/2025/01/19/coreml-optimization-playbook-en.html">CoreML Optimization Playbook (Consulting)</a></li>
  
    <li><a href="/business/analyics/2021/06/18/SALES-FORECASTING-2.html">SALES FORECASTING 2</a></li>
  
    <li><a href="/business/finance/2021/06/09/organize-and-implement-hull-and-white-1994a-interest-rate-model.html">Organize and implement Hull and White (1994a) interest rate model</a></li>
  
  </ul>
</div>


<section class="pager">
  <ul>
    
    <li class="previous"><a href="/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html" title="CoreML最適化プレイブック（受託）">&larr; Older</a></li>
    
    
    <li class="next"><a href="/Kyo.github.io/2025/01/19/founders-log-01-en.html" title="Founder's Log #01 — Weekly Update">Newer &rarr;</a></li>
    
  </ul>
</section>

<div id="disqus_thread"></div>

<script type="text/javascript">

  var disqus_developer = 1;

var disqus_shortname ='kyo';
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  </div>
  <section class="pager">
  
  
</section>



  

  <footer class="site-footer">

  <p>Copyright &copy; <a href="/Kyo.github.io/">Kyo Harada — Visage AI / Data Scientist</a></p>
  <p>Powered by <a href="https://github.com/jekyll/jekyll">Jekyll</a>
  on
  <a href="https://github.com/">Github</a>
  | Theme <a href="https://github.com/yulijia/freshman21/">Freshman21</a> Design by <a href="https://yulijia.net">Lijia Yu</a>

</footer>


</div>

<!-- Lazy loading script -->
<script src="/Kyo.github.io/assets/js/lazyfix.js"></script>

</body>

</html>
