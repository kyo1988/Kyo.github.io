<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width initial-scale=1">
<meta property="og:title" content="CoreML最適化プレイブック（受託）">

<title>CoreML最適化プレイブック（受託）</title>
<meta property="og:description" content="
  TL;DR
  オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。量子化→蒸留→アーキ設計の順序で最適化。


設計判断のフレームワーク

1. 量子化（Quantization）

  INT8量子化: 精度損失5%以内でモデルサイズ75%削減
  動的量子化: 推論時のみ量子化、学習時はFP...">
<meta property="og:url" content="https://kyo1988.github.io/2025/01/19/coreml-optimization-playbook.html">
<meta property="og:site_name" content="Kyo Harada — Visage AI / Data Scientist">
<meta property="og:locale" content="ja_JP">

<meta property="article:author" content="https://www.linkedin.com/in/KyoHarada" />

<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@kyoHarada">
<meta name="twitter:creator" content="@kyoHarada">
<meta name="twitter:title" content="CoreML最適化プレイブック（受託）">
<meta name="twitter:description" content="
  TL;DR
  オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。量子化→蒸留→アーキ設計の順序で最適化。


設計判断のフレームワーク

1. 量子化（Quantization）

  INT8量子化: 精度損失5%以内でモデルサイズ75%削減
  動的量子化: 推論時のみ量子化、学習時はFP...">
<meta name="twitter:url" content="https://kyo1988.github.io/2025/01/19/coreml-optimization-playbook.html">

<meta name="keywords" content="Data Scientist, AI, CoreML, Finance, EDINET, RAG, LLM, Consulting">

<meta name="google-site-verification" content="kZFzSU3m_vE_Y0Ja60lWjUOKkeGpV7Ch3CvfLeP8Di4" />

<link rel="icon" href="/Kyo.github.io/images/IMG_0168.ico">
<link rel="stylesheet" href="/Kyo.github.io/css/main.css">
<link rel="canonical" href="https://kyo1988.github.io/2025/01/19/coreml-optimization-playbook.html">
<link rel="alternate" type="application/atom+xml" title="Kyo Harada — Visage AI / Data Scientist" href="https://kyo1988.github.io/feed.xml" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script async defer src="//assets.pinterest.com/js/pinit.js"></script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T222J2Q');</script>
<!-- End Google Tag Manager -->

</head>
<!-- <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-196500796-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-196500796-1');
</script> -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
    CommonHTML: { matchFontHeight: false },
    displayAlign: "left",
    displayIndent: "2em",
    TeX: {
      equationNumbers: { autoNumber: "AMS" },
    }
  });
</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS_CHTML"></script>
<!-- <link type="application/atom+xml" rel="alternate" href="https://kyo1988.github.io/Kyo.github.io/atom.xml" title="Kyo Harada — Visage AI / Data Scientist" /> -->
<!-- <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>CoreML最適化プレイブック（受託） | Kyo Harada — Visage AI / Data Scientist</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="CoreML最適化プレイブック（受託）" />
<meta name="author" content="Kyo Harada" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="量子化/蒸留/アーキ設計の意思決定、評価指標、落とし穴。オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。" />
<meta property="og:description" content="量子化/蒸留/アーキ設計の意思決定、評価指標、落とし穴。オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。" />
<link rel="canonical" href="https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html" />
<meta property="og:url" content="https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html" />
<meta property="og:site_name" content="Kyo Harada — Visage AI / Data Scientist" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-19T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CoreML最適化プレイブック（受託）" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kyo Harada"},"dateModified":"2025-01-19T00:00:00+09:00","datePublished":"2025-01-19T00:00:00+09:00","description":"量子化/蒸留/アーキ設計の意思決定、評価指標、落とし穴。オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。","headline":"CoreML最適化プレイブック（受託）","mainEntityOfPage":{"@type":"WebPage","@id":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html"},"url":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html"}</script>
<!-- End Jekyll SEO tag -->
 -->

<body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T222J2Q"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="container">

  <header class="site-header">

  <div class="wrapper">

    <h1 class="site-title"><a href="/Kyo.github.io">Kyo Harada — Visage AI / Data Scientist</a></h1>
    <h3 class="site-meta">Founder & Data Scientist building on-device AI for skin analytics and finance-grade data products.</h3>

    <nav class="site-nav">
<!--       <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a> -->
      <div class="trigger">
        
        
        <a class="page-link" href="/Kyo.github.io/">Home</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/about/">About</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/about/">About</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/archives/">Archives</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/case-studies/">Case Studies</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/categories/">Categories</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/tags/">Tags</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/guestbook/">Guestbook</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/xml/feed.xml">Subscribe</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/DataScience/">DataScience</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/visualization/">Visualization</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/marketing/">Marketing</a>
        
        
        
        
        
        <a class="page-link" href="/Kyo.github.io/Investment/">Investment</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/Travel/">Travel</a>
        
        
        
        
        
        <a class="page-link" href="/Kyo.github.io/newsletter/">Newsletter</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/press-kit/">Press Kit</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/xml/sitemap.xml">Sitemap</a>
        
        
        
        <a class="page-link" href="/Kyo.github.io/work-with-me/">Work with me</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </div>
    </nav>

  </div>

</header>


  

  <div class="page-content">
    <div class="wrapper">
      <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>CoreML最適化プレイブック（受託） | Kyo Harada — Visage AI / Data Scientist</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="CoreML最適化プレイブック（受託）" />
<meta name="author" content="Kyo Harada" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="量子化/蒸留/アーキ設計の意思決定、評価指標、落とし穴。オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。" />
<meta property="og:description" content="量子化/蒸留/アーキ設計の意思決定、評価指標、落とし穴。オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。" />
<link rel="canonical" href="https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html" />
<meta property="og:url" content="https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html" />
<meta property="og:site_name" content="Kyo Harada — Visage AI / Data Scientist" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-19T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CoreML最適化プレイブック（受託）" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Kyo Harada"},"dateModified":"2025-01-19T00:00:00+09:00","datePublished":"2025-01-19T00:00:00+09:00","description":"量子化/蒸留/アーキ設計の意思決定、評価指標、落とし穴。オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。","headline":"CoreML最適化プレイブック（受託）","mainEntityOfPage":{"@type":"WebPage","@id":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html"},"url":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html"}</script>
<!-- End Jekyll SEO tag -->



<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "CoreML最適化プレイブック（受託）",
  "description": "量子化/蒸留/アーキ設計の意思決定、評価指標、落とし穴。オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。",
  "datePublished": "2025-01-19T00:00:00+0900",
  "dateModified": "2025-01-19T00:00:00+0000",
  "author": {
    "@type": "Person",
    "name": "Kyo Harada",
    "sameAs": [
      "https://github.com/kyo1988",
      "https://www.visageaiconsulting.com/",
      "https://www.linkedin.com/in/KyoHarada"
    ]
  },
  "publisher": {
    "@type": "Organization",
    "name": "Visage AI Consulting"
  },
  "mainEntityOfPage": {"@type":"WebPage","@id":"https://kyo1988.github.io/Kyo.github.io/2025/01/19/coreml-optimization-playbook.html"}
}
</script>

<div class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 itemprop="name" class="post-title">CoreML最適化プレイブック（受託）</h1>
    <meta itemprop="keywords" content="CoreML,On-device,Case-Study,iOS,Machine-Learning" />
    <p class="post-meta">
    Posted in
    
    
    and tagged
    
    <a href="/Kyo.github.io/tags/#CoreML" title="CoreML">CoreML</a>, 
    
    <a href="/Kyo.github.io/tags/#On-device" title="On-device">On-device</a>, 
    
    <a href="/Kyo.github.io/tags/#Case-Study" title="Case-Study">Case-Study</a>, 
    
    <a href="/Kyo.github.io/tags/#iOS" title="iOS">iOS</a>, 
    
    <a href="/Kyo.github.io/tags/#Machine-Learning" title="Machine-Learning">Machine-Learning</a>
    
    
    <time itemprop="datePublished" datetime="2025-01-19">
    on Jan 19, 2025
    </time>
    </p>
  </header>

  <article class="post-content" itemprop="articleBody">
    <div class="tldr">
  <strong>TL;DR</strong>
  <p>オンデバイスで品質を落とさず軽量化する設計判断の要点を3分で。量子化→蒸留→アーキ設計の順序で最適化。</p>
</div>

<h2 id="設計判断のフレームワーク">設計判断のフレームワーク</h2>

<h3 id="1-量子化quantization">1. 量子化（Quantization）</h3>
<ul>
  <li><strong>INT8量子化</strong>: 精度損失5%以内でモデルサイズ75%削減</li>
  <li><strong>動的量子化</strong>: 推論時のみ量子化、学習時はFP32維持</li>
  <li><strong>静的量子化</strong>: 事前キャリブレーション、より高い圧縮率</li>
</ul>

<h3 id="2-蒸留knowledge-distillation">2. 蒸留（Knowledge Distillation）</h3>
<ul>
  <li><strong>Teacher-Student</strong>: 大規模モデル→軽量モデルへの知識転移</li>
  <li><strong>温度パラメータ</strong>: T=3-5でソフトラベル生成</li>
  <li><strong>損失関数</strong>: ハードラベル + ソフトラベル + 特徴マップ</li>
</ul>

<h3 id="3-アーキテクチャ設計">3. アーキテクチャ設計</h3>
<ul>
  <li><strong>MobileNet</strong>: 深度分離畳み込みで計算量削減</li>
  <li><strong>EfficientNet</strong>: 複合スケーリングで効率最大化</li>
  <li><strong>SqueezeNet</strong>: Fire Moduleでパラメータ数削減</li>
</ul>

<h2 id="評価指標">評価指標</h2>

<div class="key-takeaways">
  <strong>Key Takeaways</strong>
  <ul>
    
    
      <li>精度: Top-1/Top-5 Accuracy</li>
    
      <li>推論速度: FPS (Frames Per Second)</li>
    
      <li>モデルサイズ: MB単位</li>
    
      <li>メモリ使用量: RAM/VRAM</li>
    
      <li>バッテリー消費: mAh/推論</li>
    
  </ul>
</div>

<h2 id="落とし穴と対策">落とし穴と対策</h2>

<h3 id="よくある失敗パターン">よくある失敗パターン</h3>
<ol>
  <li><strong>過度な量子化</strong>: 精度大幅低下</li>
  <li><strong>不適切な蒸留</strong>: 温度設定ミス</li>
  <li><strong>アーキ選択ミス</strong>: タスクとモデルの不適合</li>
</ol>

<h3 id="対策">対策</h3>
<ul>
  <li><strong>段階的最適化</strong>: 1つずつ適用して効果測定</li>
  <li><strong>A/Bテスト</strong>: 複数手法の並行比較</li>
  <li><strong>実機検証</strong>: シミュレータではなく実デバイスでテスト</li>
</ul>

<h2 id="成果物セット">成果物セット</h2>

<section class="qa">
  <h2>Q&amp;A</h2>
  
  <dl>
  
    
    
    
    
      <dt>どの手法をどう選ぶ？</dt>
      <dd>精度要求と制約から逆算して選択。精度優先→蒸留、サイズ優先→量子化</dd>
    
  
    
    
    
    
      <dt>評価指標は？</dt>
      <dd>精度・速度・サイズ・メモリ・バッテリーの5軸で総合評価</dd>
    
  
    
    
    
    
      <dt>納品物とスケジュールは？</dt>
      <dd>最適化モデル・実装ガイド・性能レポート（2-6週間）</dd>
    
  
  </dl>
</section>

<h2 id="実装例">実装例</h2>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// CoreML最適化の実装例</span>
<span class="kd">import</span> <span class="kt">CoreML</span>

<span class="kd">class</span> <span class="kt">OptimizedModelManager</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">loadOptimizedModel</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">MLModel</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">modelURL</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">url</span><span class="p">(</span><span class="nv">forResource</span><span class="p">:</span> <span class="s">"optimized_model"</span><span class="p">,</span> <span class="nv">withExtension</span><span class="p">:</span> <span class="s">"mlmodelc"</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">nil</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">try</span><span class="p">?</span> <span class="kt">MLModel</span><span class="p">(</span><span class="nv">contentsOf</span><span class="p">:</span> <span class="n">modelURL</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">predict</span><span class="p">(</span><span class="nv">input</span><span class="p">:</span> <span class="kt">MLFeatureProvider</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">MLFeatureValue</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">model</span> <span class="o">=</span> <span class="nf">loadOptimizedModel</span><span class="p">()</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">nil</span> <span class="p">}</span>
        <span class="k">return</span> <span class="k">try</span><span class="p">?</span> <span class="n">model</span><span class="o">.</span><span class="nf">prediction</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="n">input</span><span class="p">)</span><span class="o">.</span><span class="nf">featureValue</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="s">"output"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="参考資料">参考資料</h2>

<ul>
  <li><a href="https://developer.apple.com/documentation/coreml">CoreML Documentation</a></li>
  <li><a href="https://developer.apple.com/machine-learning/models/">Model Optimization Guide</a></li>
  <li><a href="https://developer.apple.com/videos/">WWDC Sessions</a></li>
</ul>

<div class="cta">
  <h3>相談・見積りのご依頼</h3>
  <p>小さく速く、成果物ベースでご一緒します。</p>
  <p>
    <a class="btn" href="/work-with-me/">Work with me</a>
    <a class="btn ghost" href="/newsletter/">無料ニュースレター</a>
  </p>
</div>

<div class="related">
  <h3>次に読む</h3>
  <ul>
  
    
      
      
      
        <li><a href="/Kyo.github.io/2025/01/19/rag-audit-checklist.html">RAGミニ監査チェックリスト（無料DL）</a></li>
        
      
    
  
    
      
      
      
    
  
    
      
      
      
    
  
    
      
      
      
        <li><a href="/Kyo.github.io/2025/01/19/edinet-db-howto.html">EDINET XBRLで作る投資家級データベース</a></li>
        
      
    
  
    
  
    
      
      
      
        <li><a href="/Kyo.github.io/2025/01/19/coreml-optimization-playbook-en.html">CoreML Optimization Playbook (Consulting)</a></li>
        
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
  </ul>
</div>


  </article>
  <hr />
</div>


<div>
  <h1>Related Posts</h1>
  <ul>
  
    <li><a href="/2025/01/19/rag-audit-checklist.html">RAGミニ監査チェックリスト（無料DL）</a></li>
  
    <li><a href="/2025/01/19/founders-log-01.html">Founder's Log #01 — 週報</a></li>
  
    <li><a href="/2025/01/19/founders-log-01-en.html">Founder's Log #01 — Weekly Update</a></li>
  
    <li><a href="/2025/01/19/edinet-db-howto.html">EDINET XBRLで作る投資家級データベース</a></li>
  
    <li><a href="/2025/01/19/coreml-optimization-playbook-en.html">CoreML Optimization Playbook (Consulting)</a></li>
  
    <li><a href="/business/analyics/2021/06/18/SALES-FORECASTING-2.html">SALES FORECASTING 2</a></li>
  
    <li><a href="/business/finance/2021/06/09/organize-and-implement-hull-and-white-1994a-interest-rate-model.html">Organize and implement Hull and White (1994a) interest rate model</a></li>
  
  </ul>
</div>


<section class="pager">
  <ul>
    
    <li class="previous"><a href="/Kyo.github.io/2025/01/19/coreml-optimization-playbook-en.html" title="CoreML Optimization Playbook (Consulting)">&larr; Older</a></li>
    
    
    <li class="next"><a href="/Kyo.github.io/2025/01/19/edinet-db-howto.html" title="EDINET XBRLで作る投資家級データベース">Newer &rarr;</a></li>
    
  </ul>
</section>

<div id="disqus_thread"></div>

<script type="text/javascript">

  var disqus_developer = 1;

var disqus_shortname ='kyo';
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
  </div>
  <section class="pager">
  
  
</section>



  

  <footer class="site-footer">

  <p>Copyright &copy; <a href="/Kyo.github.io/">Kyo Harada — Visage AI / Data Scientist</a></p>
  <p>Powered by <a href="https://github.com/jekyll/jekyll">Jekyll</a>
  on
  <a href="https://github.com/">Github</a>
  | Theme <a href="https://github.com/yulijia/freshman21/">Freshman21</a> Design by <a href="https://yulijia.net">Lijia Yu</a>

</footer>


</div>

<!-- Lazy loading script -->
<script src="/Kyo.github.io/assets/js/lazyfix.js"></script>

</body>

</html>
